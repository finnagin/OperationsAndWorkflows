id: overlay_clinical_info
subclass_of: overlay
name: overlay clinical info
description: This operation overlay edges with information obtained from the knowledge provider (KP) Columbia Open Health Data (COHD). This KP has a number of different functionalities, such as "paired_concept_frequency", "observed_expected_ratio", etc. which are mutually exclusive DSL parameters. All information is derived from a 5 year hierarchical dataset: Counts for each concept include patients from descendant concepts. This includes clinical data from 2013-2017 and includes 1,731,858 different patients. This information is then included as an edge attribute. You have the choice of applying this to all edges in the knowledge graph, or only between specified subject/object qnode id's. If the later, virtual edges are added with the relation specified by "virtual_relation_label". These virtual edges have the following types: "paired_concept_frequency" has the virtual edge type "has_paired_concept_frequency_with"; "observed_expected_ratio" has the virtual edge type "has_observed_expected_ratio_with"; "chi_square" has the virtual edge type "has_chi_square_with".
examples:
- input: overlay/messages/19_input_clinical_info.json
  output: overlay/messages/20_output_clinical_info.json
  parameters:
    COHD_method: ""
    virtual_relation_label: ""
    subject_qnode_key: ""
    object_qnode_key: ""
input_requirements: []
output_guarantees: []
allowed_changes:
- add qedges
- edit kedges
- add bindings to results
parameters:
  type: object
  properties:
    COHD_method:
      description: Which measure from COHD should be considered.
      type: string
      example: [paired_concept_frequency, observed_expected_ratio, chi_square]
      default: "paired_concept_frequency"
    virtual_relation_label:
      description: An optional label to help identify the virtual edge in the relation field.
      type: string
      example: N1
    subject_qnode_key:
      description: A specific subject query node id (optional, otherwise applied to all edges, must have a virtual_relation_label to use this parameter)
      type: string
      example: n01
    object_qnode_key:
      description: A specific object query node id (optional, otherwise applied to all edges, must have a virtual_relation_label to use this parameter)
      type: string
      example: n02 
  required: ""
